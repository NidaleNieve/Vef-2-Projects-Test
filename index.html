<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fun Interactive Site</title>
    <link rel="stylesheet" href="betra-styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <div class="confetti-container"></div>
    <div class="container">
        <header class="header">
            <div class="logo">Fun Site</div>
            <div class="theme-toggle">
                <i class="fas fa-sun"></i>
            </div>
        </header>
        
        <div class="hero">
            <h1 class="animated-title">Hello World <i class="fas fa-globe-americas"></i></h1>
            <div class="subtitle">Welcome to the interactive playground</div>
        </div>
        
        <div class="content">
            <h2 class="animated-subtitle">Ãžetta er ekki <span class="highlight">venjulegt</span></h2>
            
            <div class="interactive-boxes">
                <div class="fun-box" id="box1">
                    <i class="fas fa-magic icon"></i>
                    <span>Click me!</span>
                </div>
                <div class="fun-box" id="box2">
                    <i class="fas fa-lightbulb icon"></i>
                    <span>Hover over me!</span>
                </div>
                <div class="fun-box" id="box3">
                    <i class="fas fa-rocket icon"></i>
                    <span>Double click me!</span>
                </div>
            </div>
            
            <div class="message-board">
                <div class="message">Try interacting with the elements!</div>
            </div>
        </div>
        
        <footer class="footer">
            <div class="footer-content">Made with <i class="fas fa-heart"></i> and CSS magic</div>
        </footer>
    </div>

    <script>
        // Simple interactions
        document.getElementById('box1').addEventListener('click', function() {
            this.classList.toggle('active');
            document.querySelector('.message').textContent = 'Box clicked! ðŸŽ‰';
        });
        
        document.getElementById('box2').addEventListener('mouseover', function() {
            this.classList.add('hover');
            document.querySelector('.message').textContent = 'Nice hover! âœ¨';
        });
        
        document.getElementById('box2').addEventListener('mouseout', function() {
            this.classList.remove('hover');
        });
        
        document.getElementById('box3').addEventListener('dblclick', function() {
            this.classList.toggle('launched');
            document.querySelector('.message').textContent = 'Rocket launched! ðŸš€';
        });
        
        // Enhanced script for box3 to show heartbeat effect on hover
        document.getElementById('box3').addEventListener('mouseover', function() {
            const icon = this.querySelector('.icon');
            icon.style.animation = 'rocketBounce 1.2s infinite';
        });
        document.getElementById('box3').addEventListener('mouseout', function() {
            const icon = this.querySelector('.icon');
            icon.style.animation = '';
        });

        // ----------------------
        // Confetti Physics Setup
        // ----------------------
        const confettiContainer = document.querySelector('.confetti-container');
        const colors = ['#4285f4', '#34a853', '#fbbc05', '#db4437', '#0f9d58', '#ff6d00', '#ab47bc'];

        const confettiPieces = [];
        let rafId = null;

        // Track upward scroll to push confetti up with the site
        let lastScrollY = window.scrollY;
        let scrollUpImpulse = 0;
        window.addEventListener('scroll', () => {
          const y = window.scrollY;
          const deltaUp = lastScrollY - y; // positive when scrolling up
          if (deltaUp > 0) {
            scrollUpImpulse = Math.min(80, scrollUpImpulse + deltaUp);
          }
          lastScrollY = y;
        });

        function currentFloorY(size = 0) {
          return window.scrollY + window.innerHeight - size; // viewport bottom in page coords
        }

        function spawnConfettiBurst(originX, originY, count = 160) {
          for (let i = 0; i < count; i++) {
            const size = Math.random() * 10 + 5;
            const piece = document.createElement('div');
            piece.className = 'confetti';
            piece.style.width = `${size}px`;
            piece.style.height = `${size}px`;
            piece.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
            piece.style.borderRadius = Math.random() > 0.7 ? '50%' : '3px';

            // Initial position (slight jitter around origin)
            const startX = originX + (Math.random() - 0.5) * 60;
            const startY = originY + (Math.random() - 0.5) * 20;

            // Launch with wider spread and stronger upward energy
            // Angle biased upwards (-90deg +/- 90deg)
            const angle = (-Math.PI / 2) + (Math.random() - 0.5) * Math.PI; 
            const speed = 5 + Math.random() * 9; // 5..14
            const vx = Math.cos(angle) * speed;
            const vy = Math.sin(angle) * speed; // negative is upward

            confettiContainer.appendChild(piece);

            confettiPieces.push({
              el: piece,
              x: startX,
              y: startY,
              vx,
              vy,
              size,
              rot: Math.random() * 360,
              vrot: (Math.random() - 0.5) * 14,
              sw: Math.random() * 1000, // swirl seed
              settled: false
            });
          }
          startConfettiLoop();
        }

        function startConfettiLoop() {
          if (rafId) return;
          const gravity = 0.35;
          const airDrag = 0.994;
          const bounceDamp = 0.35;
          const wallDamp = 0.28; // softer side-wall bounce
          const wallMargin = 2;  // keep off the exact edge

          function step() {
            rafId = requestAnimationFrame(step);

            // Viewport-aligned walls in page coordinates
            const leftWall = window.scrollX + wallMargin;
            const rightWall = window.scrollX + document.documentElement.clientWidth - wallMargin;

            for (const p of confettiPieces) {
              if (!p.settled) {
                // Physics
                p.vy += gravity;

                // Gentle swirl drift for wider spread
                p.vx += Math.sin((p.y + p.sw) * 0.06) * 0.05;

                // Apply air drag
                p.vx *= airDrag;
                p.vy *= airDrag;

                // Scroll-up impulse to make pieces go up with the site when user scrolls up
                if (scrollUpImpulse > 0.1) {
                  p.vy -= scrollUpImpulse * 0.02;
                }

                // Integrate
                p.x += p.vx;
                p.y += p.vy;
                p.rot += p.vrot;

                // Side-wall collisions (soft bounce)
                const rightLimit = rightWall - p.size;
                if (p.x <= leftWall) {
                  p.x = leftWall;
                  p.vx = Math.abs(p.vx) * wallDamp;
                } else if (p.x >= rightLimit) {
                  p.x = rightLimit;
                  p.vx = -Math.abs(p.vx) * wallDamp;
                }

                // Floor collision against current floor
                const floorY = currentFloorY(p.size);
                if (p.y >= floorY) {
                  p.y = floorY;
                  p.vy = -Math.abs(p.vy) * bounceDamp;
                  p.vx *= 0.95;
                  p.vrot *= 0.9;

                  if (Math.abs(p.vy) < 0.6) {
                    p.vy = 0;
                    p.vx *= 0.9;
                    p.vrot = 0;
                    p.settled = true;
                  }
                }
              } else {
                // If floor moves down (scrolling), let it fall again
                const newFloorY = currentFloorY(p.size);
                if (p.y < newFloorY - 0.5) {
                  p.settled = false;
                }
              }

              // Render
              p.el.style.left = `${p.x}px`;
              p.el.style.top = `${p.y}px`;
              p.el.style.transform = `rotate(${p.rot}deg)`;
            }

            // Decay the scroll impulse smoothly
            scrollUpImpulse *= 0.9;

            // Stop loop only when nothing remains
            if (confettiPieces.length === 0) {
              cancelAnimationFrame(rafId);
              rafId = null;
            }
          }
          rafId = requestAnimationFrame(step);
        }

        // Confetti pop ripple and burst from Hello World center
        document.querySelector('.animated-title').addEventListener('click', function(e) {
          const rect = this.getBoundingClientRect();
          const originX = window.scrollX + rect.left + rect.width / 2;
          const originY = window.scrollY + rect.top + rect.height / 2;

          // Pop ripple at click location
          const popElement = document.createElement('div');
          popElement.classList.add('pop-animation');
          popElement.style.left = (e.pageX - 50) + 'px';
          popElement.style.top = (e.pageY - 50) + 'px';
          document.body.appendChild(popElement);
          setTimeout(() => popElement.remove(), 650);

          // Wider, higher burst
          spawnConfettiBurst(originX, originY, 180);

          // Update message
          const msg = document.querySelector('.message');
          if (msg) msg.textContent = 'Confetti party! ðŸŽŠ';
        });

        // On resize, physics already uses dynamic floor. No extra code needed.
        // On scroll, physics loop checks the new floor and releases settled pieces to fall again.

        // Theme toggle
        document.querySelector('.theme-toggle').addEventListener('click', function() {
            document.body.classList.toggle('dark-mode');
            const icon = this.querySelector('i');
            if (icon.classList.contains('fa-sun')) {
                icon.classList.replace('fa-sun', 'fa-moon');
            } else {
                icon.classList.replace('fa-moon', 'fa-sun');
            }
        });
    </script>
</body>
</html>